# Options é¡µé¢ UI/UX è®¾è®¡æ–¹æ¡ˆ

## åŠŸèƒ½éœ€æ±‚

ä¸º Chrome æ‰©å±•çš„ Options é¡µé¢è®¾è®¡ä¸€å¥—å®Œæ•´çš„ç”¨æˆ·ç•Œé¢ï¼Œç”¨äºç®¡ç†å„ç±»é…ç½®æ•°æ®ã€‚

### æ ¸å¿ƒåŠŸèƒ½

1. **æ•°æ®ç®¡ç†** - å¯¹ä»¥ä¸‹ 6 å¼ è¡¨è¿›è¡Œ CRUD æ“ä½œ
   - Agent è¡¨
   - ç«¯å£è¡¨
   - URI è¡¨
   - å°¾éƒ¨å‚æ•°è¡¨
   - OPTY å‚æ•°è¡¨
   - ç»„åˆè¡¨

2. **å¿«é€Ÿåˆ‡æ¢** - é€šè¿‡ç»„åˆè¡¨å¿«é€Ÿåˆ‡æ¢é…ç½®å¹¶åº”ç”¨åˆ°è¿è¡Œç¯å¢ƒ

---

## UI ç»“æ„è®¾è®¡

### æ•´ä½“å¸ƒå±€

é‡‡ç”¨ **ä¾§è¾¹å¯¼èˆª + ä¸»å†…å®¹åŒº** çš„ç»å…¸å¸ƒå±€ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IA Configuration Options              [ä¿å­˜] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                          â”‚
â”‚   ä¾§è¾¹å¯¼èˆª       â”‚       ä¸»å†…å®¹åŒº           â”‚
â”‚                  â”‚                          â”‚
â”‚  â€¢ Agents        â”‚   [å½“å‰é€‰ä¸­ç±»å‹çš„å†…å®¹]  â”‚
â”‚  â€¢ ç«¯å£          â”‚                          â”‚
â”‚  â€¢ URI           â”‚                          â”‚
â”‚  â€¢ å°¾éƒ¨å‚æ•°      â”‚                          â”‚
â”‚  â€¢ OPTY å‚æ•°     â”‚                          â”‚
â”‚  â€¢ ç»„åˆé…ç½®      â”‚                          â”‚
â”‚                  â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å„ç±»å‹æ•°æ®çš„ UI è®¾è®¡

### 1. é€šç”¨è¡¨æ ¼è§†å›¾ï¼ˆé€‚ç”¨äºæ‰€æœ‰ç±»å‹ï¼‰

é‡‡ç”¨ **å¡ç‰‡å¼åˆ—è¡¨** æˆ– **è¡¨æ ¼è§†å›¾** ä¸¤ç§å‘ˆç°æ–¹å¼ï¼š

#### æ–¹æ¡ˆ Aï¼šå¡ç‰‡å¼åˆ—è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ æ–° Agent      [æœç´¢æ¡†]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Agent #1                  â”‚  â”‚
â”‚  â”‚  ç”¨æˆ·å: user_123           â”‚  â”‚
â”‚  â”‚  ID: 550e8400-e29b...       â”‚  â”‚
â”‚  â”‚  [ç¼–è¾‘] [åˆ é™¤] [å¤åˆ¶ID]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Agent #2                  â”‚  â”‚
â”‚  â”‚  ç”¨æˆ·å: user_456           â”‚  â”‚
â”‚  â”‚  ID: 660e8400-e29c...       â”‚  â”‚
â”‚  â”‚  [ç¼–è¾‘] [åˆ é™¤] [å¤åˆ¶ID]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ–¹æ¡ˆ Bï¼šè¡¨æ ¼è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ æ–° Agent                      [æœç´¢]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID       â”‚ ç”¨æˆ·å       â”‚ æ“ä½œ       â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 550e84... â”‚ user_123     â”‚ [ç¼–è¾‘][åˆ é™¤][å¤åˆ¶]  â”‚
â”‚ 660e84... â”‚ user_456     â”‚ [ç¼–è¾‘][åˆ é™¤][å¤åˆ¶]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¨è**ï¼šå¡ç‰‡å¼åˆ—è¡¨æ›´é€‚åˆæ•°æ®é‡ä¸å¤§çš„åœºæ™¯ï¼Œè§†è§‰æ•ˆæœæ›´å¥½ï¼Œæ“ä½œæ›´ç›´è§‚ã€‚

---

### 2. Agent ç®¡ç†

#### æ·»åŠ /ç¼–è¾‘è¡¨å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ  / ç¼–è¾‘ Agent                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·å *                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  ID *                               â”‚
â”‚  [__________________________]       â”‚
â”‚  [ç”ŸæˆéšæœºID]                       â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [ä¿å­˜]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. ç«¯å£ç®¡ç†

#### æ·»åŠ /ç¼–è¾‘è¡¨å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ  / ç¼–è¾‘ ç«¯å£                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç«¯å£å· *                           â”‚
â”‚  [__________________________]      â”‚
â”‚  (å¸¸è§ç«¯å£: [8080] [5432] [3000])  â”‚
â”‚                                      â”‚
â”‚  æè¿°è¯´æ˜                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [ä¿å­˜]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. URI ç®¡ç†

#### æ·»åŠ /ç¼–è¾‘è¡¨å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ  / ç¼–è¾‘ URI                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  URI *                              â”‚
â”‚  [__________________________]      â”‚
â”‚  (ç¤ºä¾‹: https://api.example.com)   â”‚
â”‚                                      â”‚
â”‚  æè¿°è¯´æ˜                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [ä¿å­˜]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5. é”®å€¼å¯¹å‚æ•°ç®¡ç†ï¼ˆå°¾éƒ¨å‚æ•° & OPTY å‚æ•°ï¼‰

ç”±äºéœ€è¦å­˜å‚¨å¤šä¸ªé”®å€¼å¯¹ï¼Œé‡‡ç”¨ **åŠ¨æ€è¡¨å•** è®¾è®¡ï¼š

#### æ·»åŠ /ç¼–è¾‘è¡¨å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ  / ç¼–è¾‘ å°¾éƒ¨å‚æ•°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‚æ•°å *                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  å‚æ•°å€¼ *                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [ä¿å­˜]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### OPTY å‚æ•°ç‰¹æ®Šæç¤º

åœ¨æ·»åŠ /ç¼–è¾‘ OPTY å‚æ•°æ—¶ï¼Œæ·»åŠ éªŒè¯å’Œæç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ  / ç¼–è¾‘ OPTY å‚æ•°            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‚æ•°å *                           â”‚
â”‚  [OPTY__________]                  â”‚
â”‚  âš ï¸ å¿…é¡»ä»¥ "OPTY" å¼€å¤´              â”‚
â”‚                                      â”‚
â”‚  å‚æ•°å€¼ *                           â”‚
â”‚  [__________________________]      â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [ä¿å­˜]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6. ç»„åˆé…ç½®ç®¡ç†ï¼ˆæ ¸å¿ƒäº¤äº’ï¼‰

#### ç»„åˆåˆ—è¡¨è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ æ–°ç»„åˆ          [æœç´¢æ¡†]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“¦ å¼€å‘ç¯å¢ƒé…ç½®             â”‚  â”‚
â”‚  â”‚  Agent: user_123             â”‚  â”‚
â”‚  â”‚  Port: 8080                 â”‚  â”‚
â”‚  â”‚  URI: https://dev.api.com   â”‚  â”‚
â”‚  â”‚  å°¾éƒ¨å‚æ•°: 2ä¸ª               â”‚  â”‚
â”‚  â”‚  OPTY å‚æ•°: 1ä¸ª              â”‚  â”‚
â”‚  â”‚  [ç¼–è¾‘] [åˆ é™¤] [åº”ç”¨é…ç½®]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“¦ ç”Ÿäº§ç¯å¢ƒé…ç½®             â”‚  â”‚
â”‚  â”‚  Agent: user_prod            â”‚  â”‚
â”‚  â”‚  Port: 443                   â”‚  â”‚
â”‚  â”‚  URI: https://api.example.comâ”‚  â”‚
â”‚  â”‚  å°¾éƒ¨å‚æ•°: 3ä¸ª               â”‚  â”‚
â”‚  â”‚  OPTY å‚æ•°: 2ä¸ª              â”‚  â”‚
â”‚  â”‚  [ç¼–è¾‘] [åˆ é™¤] [åº”ç”¨é…ç½®]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åˆ›å»º/ç¼–è¾‘ç»„åˆè¡¨å•ï¼ˆåˆ†æ­¥å¼•å¯¼ï¼‰

é‡‡ç”¨ **åˆ†æ­¥å¼è¡¨å•**ï¼ˆWizardï¼‰æ¥é™ä½è®¤çŸ¥è´Ÿæ‹…ï¼š

**ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬ä¿¡æ¯**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 1/3: åŸºæœ¬ä¿¡æ¯    [<] [>]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç»„åˆæ ‡é¢˜ *                         â”‚
â”‚  [å¼€å‘ç¯å¢ƒé…ç½®]                    â”‚
â”‚                                      â”‚
â”‚  æè¿°è¯´æ˜                           â”‚
â”‚  [ç”¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒçš„é…ç½®]          â”‚
â”‚                                      â”‚
â”‚              [ä¸‹ä¸€æ­¥]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬äºŒæ­¥ï¼šé€‰æ‹©åŸºç¡€é…ç½®**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 2/3: é€‰æ‹©åŸºç¡€é…ç½®  [<] [>]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent                              â”‚
â”‚  [é€‰æ‹© Agent â–¼] â†’ user_123          â”‚
â”‚                                      â”‚
â”‚  Port                               â”‚
â”‚  [é€‰æ‹©ç«¯å£ â–¼] â†’ 8080                â”‚
â”‚                                      â”‚
â”‚  URI                                â”‚
â”‚  [é€‰æ‹© URI â–¼] â†’ https://dev.api.comâ”‚
â”‚                                      â”‚
â”‚  [ä¸Šä¸€æ­¥]       [ä¸‹ä¸€æ­¥]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©å‚æ•°**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 3/3: é€‰æ‹©å‚æ•°      [<] [>]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å°¾éƒ¨å‚æ•°                           â”‚
â”‚  â˜‘ debug_mode=on                  â”‚
â”‚  â˜‘ verbose_logging=true            â”‚
â”‚  â˜ cache_ttl=300                   â”‚
â”‚  [+ æ·»åŠ æ›´å¤šå‚æ•°]                  â”‚
â”‚                                      â”‚
â”‚  OPTY å‚æ•°                          â”‚
â”‚  â˜‘ OPTY_TIMEOUT=30                 â”‚
â”‚  â˜ OPTY_RETRY=3                    â”‚
â”‚  [+ æ·»åŠ æ›´å¤šå‚æ•°]                  â”‚
â”‚                                      â”‚
â”‚  [ä¸Šä¸€æ­¥]       [ä¿å­˜é…ç½®]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è¿è¡Œç•Œé¢è®¾è®¡ï¼ˆåº”ç”¨ç»„åˆï¼‰

å½“ç”¨æˆ·ç‚¹å‡»"åº”ç”¨é…ç½®"æ—¶ï¼Œå±•ç¤ºä¸€ä¸ªç¡®è®¤ç•Œé¢ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                             â”‚
â”‚     âœ“ åº”ç”¨é…ç½®æˆåŠŸ                          â”‚
â”‚                                             â”‚
â”‚     å·²åº”ç”¨: "å¼€å‘ç¯å¢ƒé…ç½®"                  â”‚
â”‚                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚ Agent: user_123                 â”‚   â”‚
â”‚     â”‚ Port: 8080                      â”‚   â”‚
â”‚     â”‚ URI: https://dev.api.com        â”‚   â”‚
â”‚     â”‚ å°¾éƒ¨å‚æ•°: 2ä¸ª                   â”‚   â”‚
â”‚     â”‚ OPTY å‚æ•°: 1ä¸ª                  â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚     [ç¡®å®š]                                  â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äº¤äº’ç»†èŠ‚

### 1. æ‹–æ‹½æ’åº

å‚æ•°åˆ—è¡¨æ”¯æŒæ‹–æ‹½æ’åºï¼Œè°ƒæ•´å‚æ•°çš„ä¼˜å…ˆçº§ã€‚

### 2. å¤åˆ¶åŠŸèƒ½

æ‰€æœ‰ ID å­—æ®µæä¾›ä¸€é”®å¤åˆ¶åŠŸèƒ½ï¼š

- Hover æ˜¾ç¤º"å¤åˆ¶"æŒ‰é’®
- ç‚¹å‡»å¤åˆ¶åæ˜¾ç¤º"å·²å¤åˆ¶"æç¤º

### 3. æœç´¢å’Œè¿‡æ»¤

æ¯ä¸ªåˆ—è¡¨é¡µé¢é¡¶éƒ¨æä¾›æœç´¢æ¡†ï¼Œæ”¯æŒå®æ—¶è¿‡æ»¤ï¼š

- Agent: æŒ‰ç”¨æˆ·åæˆ– ID æœç´¢
- å…¶ä»–ç±»å‹: æŒ‰åç§°æˆ–æè¿°æœç´¢

### 4. ç¡®è®¤å¯¹è¯æ¡†

åˆ é™¤æ“ä½œéœ€è¦äºŒæ¬¡ç¡®è®¤ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ ç¡®è®¤åˆ é™¤                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé…ç½®å—ï¼Ÿ             â”‚
â”‚  æ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚                   â”‚
â”‚                                      â”‚
â”‚  [å–æ¶ˆ]           [åˆ é™¤]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. è¡¨å•éªŒè¯

- å¿…å¡«å­—æ®µå®æ—¶éªŒè¯
- æäº¤å‰æ•´ä½“æ£€æŸ¥
- é”™è¯¯ä¿¡æ¯æ¸…æ™°æç¤º
- OPTY å‚æ•°å‰ç¼€éªŒè¯

---

## é¢œè‰²å’Œä¸»é¢˜å»ºè®®

### ä¸»è‰²è°ƒ

- Primary: `#3B82F6` (è“è‰²) - ä¸»è¦æŒ‰é’®ã€é€‰ä¸­çŠ¶æ€
- Success: `#10B981` (ç»¿è‰²) - ä¿å­˜æˆåŠŸã€åº”ç”¨æˆåŠŸ
- Danger: `#EF4444` (çº¢è‰²) - åˆ é™¤æ“ä½œ
- Warning: `#F59E0B` (æ©™è‰²) - è­¦å‘Šæç¤º

### é—´è·è§„èŒƒ

- Section é—´è·: 16px
- è¡¨å•é¡¹é—´è·: 12px
- æŒ‰é’®é—´è·: 8px
- å¡ç‰‡é—´è·: 12px

---

## æŠ€æœ¯å®ç°å»ºè®®

### ä½¿ç”¨ç»„ä»¶åº“

æ¨èä½¿ç”¨ **shadcn/ui** ç»„ä»¶åº“ï¼Œå®ƒæä¾›ï¼š

- Card, Button, Input, Select ç­‰åŸºç¡€ç»„ä»¶
- Dialog/Modal å¯¹è¯æ¡†
- Form è¡¨å•ç»„ä»¶
- Toast æ¶ˆæ¯æç¤º
- å®Œæ•´çš„ TypeScript ç±»å‹æ”¯æŒ

### çŠ¶æ€ç®¡ç†

- ä½¿ç”¨ React Context æˆ– Zustand ç®¡ç†å…¨å±€çŠ¶æ€
- æœ¬åœ°å­˜å‚¨ä½¿ç”¨ Chrome Storage API
- å®æ—¶ä¿å­˜ï¼Œé¿å…æ•°æ®ä¸¢å¤±

### å¯¼èˆªæ–¹æ¡ˆ

- ä½¿ç”¨ URL hash è·¯ç”±ï¼ˆå¦‚ `#agents`, `#combinations`ï¼‰
- æˆ–ä½¿ç”¨çŠ¶æ€é©±åŠ¨çš„è§†å›¾åˆ‡æ¢

---

## ä¸‹ä¸€æ­¥

éœ€è¦å§”æ‰˜ `frontend-ui-ux-engineer` æ¥ï¼š

1. ä¼˜åŒ–è§†è§‰è®¾è®¡ç»†èŠ‚
2. æä¾›å…·ä½“çš„ç»„ä»¶ä»£ç 
3. è®¾è®¡å“åº”å¼å¸ƒå±€
4. æ·»åŠ åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ

---

## Popup é¡µé¢è®¾è®¡

Popup é¡µé¢æ˜¯æµè§ˆå™¨æ‰©å±•çš„æ ¸å¿ƒäº¤äº’ç•Œé¢ï¼Œç”¨äºå¿«é€Ÿé€‰æ‹©å’Œåº”ç”¨ç»„åˆé…ç½®ã€‚

### æ•´ä½“å¸ƒå±€

é‡‡ç”¨ **ç´§å‡‘å‹å‚ç›´å¸ƒå±€**ï¼Œé€‚é… Popup çš„å°å°ºå¯¸ï¼ˆé€šå¸¸ 350-400px å®½åº¦ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         IA                [è®¾ç½®æŒ‰é’®]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚  é€‰æ‹©é…ç½®                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å¼€å‘ç¯å¢ƒé…ç½®               â–¼     â”‚  â”‚
â”‚  â”‚ ç”Ÿäº§ç¯å¢ƒé…ç½®                      â”‚  â”‚
â”‚  â”‚ æµ‹è¯•ç¯å¢ƒé…ç½®                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”‚  å½“å‰é…ç½®è¯¦æƒ…                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Agent: user_123                 â”‚  â”‚
â”‚  â”‚ Port: 8080                     â”‚  â”‚
â”‚  â”‚ URI: https://dev.api.com       â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ å°¾éƒ¨å‚æ•°ï¼ˆå¯ä¸´æ—¶è°ƒæ•´ï¼‰           â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ debug: [on           ] ğŸ”’   â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ verbose: [true        ] ğŸ”’   â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ OPTY å‚æ•°ï¼ˆå¯ä¸´æ—¶è°ƒæ•´ï¼‰          â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ OPTY_TIMEOUT: [30      ] ğŸ”’ â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ OPTY_RETRY: [3        ] ğŸ”’   â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”‚  [ğŸ”’ è¡¨ç¤ºå·²ä¸´æ—¶ä¿®æ”¹]                    â”‚
â”‚                                       â”‚
â”‚  [   ä¿å­˜é…ç½®   ]  [  ğŸš€ è·³è½¬  ]      â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åŠŸèƒ½è®¾è®¡

### 1. é…ç½®é€‰æ‹©

- **ä¸‹æ‹‰æ¡†**ï¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„ç»„åˆé…ç½®
- é»˜è®¤é€‰æ‹©æœ€è¿‘ä½¿ç”¨çš„é…ç½®ï¼ˆè®°å½•åœ¨ Chrome Storage ä¸­ï¼‰
- é€‰é¡¹æ ¼å¼ï¼š`title (Agent: xxx, Port: xxx)` æä¾›å¿«é€Ÿè¯†åˆ«

```typescript
interface CombinationOption {
  id: string;
  title: string;
  preview: string; // ä¾‹å¦‚ "user_123 : 8080"
}
```

### 2. é…ç½®è¯¦æƒ…å±•ç¤º

å½“é€‰ä¸­ä¸€ä¸ªç»„åˆæ—¶ï¼Œå±•ç¤ºå…¶å®Œæ•´é…ç½®ï¼š

#### åŸºç¡€ä¿¡æ¯

```
Agent: user_123
Port: 8080
URI: https://dev.api.com
```

#### å‚æ•°åˆ—è¡¨ï¼ˆå¯ç¼–è¾‘ï¼‰

æ¯ä¸ªå‚æ•°æ˜¾ç¤ºï¼š

- å‚æ•°åï¼ˆkeyï¼‰
- å½“å‰å€¼ï¼ˆvalueï¼‰
- é”å®šå›¾æ ‡ï¼ˆğŸ”’ï¼‰è¡¨ç¤ºè¯¥å€¼å·²è¢«ä¸´æ—¶ä¿®æ”¹

**äº¤äº’ç»†èŠ‚ï¼š**

- ç‚¹å‡»å‚æ•°å€¼ â†’ å˜ä¸ºè¾“å…¥æ¡†è¿›è¡Œç¼–è¾‘
- å¤±å»ç„¦ç‚¹æˆ–æŒ‰ Enter â†’ ä¿å­˜ä¸´æ—¶å€¼
- æŒ‰ Esc â†’ å–æ¶ˆä¿®æ”¹ï¼Œæ¢å¤åŸå§‹å€¼
- å®æ—¶æ˜¾ç¤ºä¿®æ”¹çŠ¶æ€ï¼ˆğŸ”’ å›¾æ ‡ï¼‰

### 3. ä¸´æ—¶è°ƒæ•´åŠŸèƒ½ï¼ˆTemporary Forceï¼‰

**æ¦‚å¿µ**ï¼šç”¨æˆ·å¯ä»¥ä¸´æ—¶ä¿®æ”¹å‚æ•°å€¼ï¼Œä¸éœ€è¦ä¿å­˜åˆ°åŸå§‹é…ç½®ä¸­ã€‚

#### å®ç°æœºåˆ¶

ä½¿ç”¨çº¯å‡½æ•°å¼ç¼–ç¨‹ï¼š

```typescript
// ç±»å‹å®šä¹‰
type TempOverride = {
  key: string;
  value: string;
  isModified: boolean;
};

// ä»ç»„åˆè·å–å‚æ•°åˆ—è¡¨ï¼ˆçº¯å‡½æ•°ï¼‰
const getParametersFromCombination = (
  combination: Combination,
): TempOverride[] => {
  const tailParams = combination.tailParameterIds
    .map((id) => getTailParameterById(id))
    .map((p) => ({ key: p.key, value: p.value, isModified: false }));

  const optyParams = combination.optyParameterIds
    .map((id) => getOptyParameterById(id))
    .map((p) => ({ key: p.key, value: p.value, isModified: false }));

  return [...tailParams, ...optyParams];
};

// åº”ç”¨ä¸´æ—¶ä¿®æ”¹ï¼ˆçº¯å‡½æ•°ï¼‰
const applyTempOverride = (
  params: TempOverride[],
  key: string,
  newValue: string,
): TempOverride[] => {
  return params.map((p) =>
    p.key === key ? { ...p, value: newValue, isModified: true } : p,
  );
};

// é‡ç½®å•ä¸ªå‚æ•°ï¼ˆçº¯å‡½æ•°ï¼‰
const resetParameter = (
  params: TempOverride[],
  originalParams: TempOverride[],
  key: string,
): TempOverride[] => {
  const originalValue = originalParams.find((p) => p.key === key)?.value;
  if (!originalValue) return params;

  return params.map((p) =>
    p.key === key ? { ...p, value: originalValue, isModified: false } : p,
  );
};

// é‡ç½®æ‰€æœ‰å‚æ•°ï¼ˆçº¯å‡½æ•°ï¼‰
const resetAllParameters = (originalParams: TempOverride[]): TempOverride[] => {
  return originalParams.map((p) => ({ ...p, isModified: false }));
};

// æ„å»ºæœ€ç»ˆçš„å‚æ•°æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆçº¯å‡½æ•°ï¼‰
const buildQueryString = (params: TempOverride[]): string => {
  return params.map((p) => `${p.key}=${p.value}`).join("&");
};
```

#### ä¸´æ—¶å­˜å‚¨

ä¸´æ—¶ä¿®æ”¹å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ˆä¸æŒä¹…åŒ–ï¼‰ï¼Œä½†å¯ä»¥åœ¨å½“å‰ä¼šè¯ä¸­ä¿æŒï¼š

```typescript
interface SessionState {
  selectedCombinationId: string | null;
  tempOverrides: Map<string, string>; // key -> temp value
}

// æ›´æ–°ä¸´æ—¶çŠ¶æ€ï¼ˆçº¯å‡½æ•°ï¼‰
const updateTempOverride = (
  state: SessionState,
  key: string,
  value: string,
): SessionState => ({
  ...state,
  tempOverrides: new Map(state.tempOverrides).set(key, value),
});
```

### 4. Save æŒ‰é’®

å°†ä¸´æ—¶ä¿®æ”¹ä¿å­˜åˆ°åŸå§‹é…ç½®ä¸­ï¼š

```typescript
// ä¿å­˜ä¸´æ—¶ä¿®æ”¹åˆ°é…ç½®ï¼ˆçº¯å‡½æ•°ï¼‰
const saveTempOverridesToCombination = async (
  combination: Combination,
  tempOverrides: Map<string, string>,
): Promise<Combination> => {
  // æ›´æ–°å°¾éƒ¨å‚æ•°
  const updatedTailParams = combination.tailParameterIds.map((id) => {
    const param = getTailParameterById(id);
    const tempValue = tempOverrides.get(param.key);

    if (tempValue) {
      const updated = { ...param, value: tempValue };
      updateTailParameter(id, updated);
      return updated;
    }
    return param;
  });

  // æ›´æ–° OPTY å‚æ•°
  const updatedOptyParams = combination.optyParameterIds.map((id) => {
    const param = getOptyParameterById(id);
    const tempValue = tempOverrides.get(param.key);

    if (tempValue) {
      const updated = { ...param, value: tempValue };
      updateOptyParameter(id, updated);
      return updated;
    }
    return param;
  });

  // æ›´æ–°ç»„åˆçš„æœ€åä¿®æ”¹æ—¶é—´
  return {
    ...combination,
    updatedAt: new Date().toISOString(),
  };
};
```

**ä¿å­˜æµç¨‹ï¼š**

1. æ£€æŸ¥æ˜¯å¦æœ‰ä¸´æ—¶ä¿®æ”¹
2. å¦‚æœæœ‰ â†’ ç¡®è®¤å¯¹è¯æ¡†ï¼š"ç¡®å®šè¦ä¿å­˜è¿™äº›ä¿®æ”¹åˆ°é…ç½®å—ï¼Ÿ"
3. ç¡®è®¤å â†’ æ›´æ–°å‚æ•°è¡¨å’Œç»„åˆè¡¨
4. æˆåŠŸæç¤ºï¼š"âœ“ é…ç½®å·²ä¿å­˜"
5. æ¸…é™¤ä¸´æ—¶çŠ¶æ€

### 5. è·³è½¬æŒ‰é’®

æ ¹æ®å½“å‰é…ç½®ï¼ˆåŒ…å«ä¸´æ—¶ä¿®æ”¹ï¼‰æ„å»º URL å¹¶è·³è½¬ï¼š

```typescript
// åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬åœ°åŸŸåï¼ˆçº¯å‡½æ•°ï¼‰
const isLocalDomain = (url: string): boolean => {
  try {
    const hostname = new URL(url).hostname;
    return (
      hostname === "localhost" ||
      hostname === "127.0.0.1" ||
      hostname.startsWith("192.168.") ||
      hostname.startsWith("10.") ||
      hostname.startsWith("172.")
    );
  } catch {
    return false;
  }
};

// æ„å»ºåŸºç¡€ URLï¼ˆçº¯å‡½æ•°ï¼‰
const buildBaseURL = (
  currentUrl: string,
  uriConfig: string,
  port: number | null,
): string => {
  const url = new URL(currentUrl);
  let base = `${url.protocol}//${url.hostname}`;

  // åªåœ¨æœ¬åœ°åŸŸåä¸”æœ‰ç«¯å£æ—¶æ·»åŠ ç«¯å£
  if (isLocalDomain(currentUrl) && port) {
    base = `${base}:${port}`;
  }

  return `${base}${uriConfig}`;
};

// æ„å»º Agent å†’å…… URLï¼ˆçº¯å‡½æ•°ï¼‰
const buildAgentImpersonationURL = (baseURL: string, agent: Agent): string => {
  return `${baseURL}/impersonate/${agent.username}`;
};

// æ„å»ºå®Œæ•´è·³è½¬ URLï¼ˆçº¯å‡½æ•°ï¼‰
const buildRedirectURL = (
  currentUrl: string,
  combination: Combination,
  params: TempOverride[],
): string => {
  // è·å–ç»„åˆä¸­çš„é…ç½®
  const agent = getAgentById(combination.agentId);
  const port = getPortById(combination.portId);
  const uri = getUriById(combination.uriId);

  // æ„å»ºåŸºç¡€ URL
  const baseURL = buildBaseURL(currentUrl, uri.uri, port?.port || null);

  // æ„å»ºå‚æ•°å­—ç¬¦ä¸²
  const queryString = buildQueryString(params);

  // ç»„åˆå®Œæ•´ URL
  return queryString ? `${baseURL}?${queryString}` : baseURL;
};
```

**è·³è½¬æµç¨‹ï¼š**

```
1. æ£€æŸ¥åŸŸåæƒé™ï¼ˆæ˜¯å¦å…è®¸ä½¿ç”¨ï¼‰
   â†“
2. æ„å»º Agent å†’å…… URL â†’ è°ƒç”¨ /impersonate/
   â†“
3. æ„å»ºç›®æ ‡ URLï¼ˆåŒ…å«å‚æ•°ï¼‰
   â†“
4. æ‰§è¡Œè·³è½¬
```

---

## å®Œæ•´çš„å‡½æ•°å¼æ¶æ„

### æ•°æ®å±‚ï¼ˆçº¯å‡½æ•°ï¼‰

```typescript
// ============ æŸ¥è¯¢å‡½æ•° ============

const getAgentById = (id: string): Agent | null => {
  /* ... */
};
const getPortById = (id: string): Port | null => {
  /* ... */
};
const getUriById = (id: string): UriEntry | null => {
  /* ... */
};
const getTailParameterById = (id: string): TailParameter | null => {
  /* ... */
};
const getOptyParameterById = (id: string): OptyParameter | null => {
  /* ... */
};
const getCombinationById = (id: string): Combination | null => {
  /* ... */
};
const getAllCombinations = (): Combination[] => {
  /* ... */
};

// ============ è½¬æ¢å‡½æ•° ============

const combinationsToOptions = (
  combinations: Combination[],
): CombinationOption[] => {
  return combinations.map((combo) => {
    const agent = getAgentById(combo.agentId);
    const port = getPortById(combo.portId);
    return {
      id: combo.id,
      title: combo.title,
      preview: `${agent?.username || "N/A"} : ${port?.port || "N/A"}`,
    };
  });
};

const combinationToParameters = (combination: Combination): TempOverride[] => {
  return getParametersFromCombination(combination);
};

// ============ ä¸šåŠ¡é€»è¾‘å‡½æ•° ============

const isLocalDomain = (url: string): boolean => {
  /* ... */
};
const buildBaseURL = (
  currentUrl: string,
  uri: string,
  port: number | null,
): string => {
  /* ... */
};
const buildQueryString = (params: TempOverride[]): string => {
  /* ... */
};
const buildRedirectURL = (
  currentUrl: string,
  combination: Combination,
  params: TempOverride[],
): string => {
  /* ... */
};

const applyTempOverride = (
  params: TempOverride[],
  key: string,
  value: string,
): TempOverride[] => {
  /* ... */
};
const resetParameter = (
  params: TempOverride[],
  original: TempOverride[],
  key: string,
): TempOverride[] => {
  /* ... */
};
const resetAllParameters = (original: TempOverride[]): TempOverride[] => {
  /* ... */
};

// ============ å­˜å‚¨æ“ä½œï¼ˆå‰¯ä½œç”¨éš”ç¦»ï¼‰ ============

const updateTailParameter = async (
  id: string,
  param: TailParameter,
): Promise<void> => {
  const storage = await getStorage();
  const updated = storage.tailParameters.map((p) => (p.id === id ? param : p));
  await setStorage({ tailParameters: updated });
};

const updateOptyParameter = async (
  id: string,
  param: OptyParameter,
): Promise<void> => {
  const storage = await getStorage();
  const updated = storage.optyParameters.map((p) => (p.id === id ? param : p));
  await setStorage({ optyParameters: updated });
};

const saveTempOverridesToCombination = async (
  combination: Combination,
  tempOverrides: Map<string, string>,
): Promise<Combination> => {
  /* ... */
};

// ============ Chrome API å°è£… ============

const getStorage = async (): Promise<StorageData> => {
  return (await chrome.storage.local.get()) as Promise<StorageData>;
};

const setStorage = async (data: Partial<StorageData>): Promise<void> => {
  return await chrome.storage.local.set(data);
};

const getCurrentTab = async (): Promise<chrome.tabs.Tab> => {
  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });
  return tab;
};

const redirectTab = async (url: string): Promise<void> => {
  const tab = await getCurrentTab();
  await chrome.tabs.update(tab.id, { url });
};
```

### UI å±‚ï¼ˆReact ç»„ä»¶ï¼‰

```typescript
// ============ Hooks ============

const useCombinationOptions = (): CombinationOption[] => {
  return useMemo(() => {
    const combinations = getAllCombinations();
    return combinationsToOptions(combinations);
  }, []);
};

const useSessionState = (combinationId: string | null): {
  params: TempOverride[];
  originalParams: TempOverride[];
  tempOverrides: Map<string, string>;
  updateOverride: (key: string, value: string) => void;
  resetOverride: (key: string) => void;
  resetAll: () => void;
} => {
  const [state, setState] = useState<SessionState>({
    selectedCombinationId: combinationId,
    tempOverrides: new Map()
  });

  const originalParams = useMemo(() => {
    if (!combinationId) return [];
    const combination = getCombinationById(combinationId);
    return combination ? combinationToParameters(combination) : [];
  }, [combinationId]);

  const params = useMemo(() => {
    return originalParams.map(p => {
      const tempValue = state.tempOverrides.get(p.key);
      return tempValue
        ? { ...p, value: tempValue, isModified: true }
        : p;
    });
  }, [originalParams, state.tempOverrides]);

  const updateOverride = useCallback((key: string, value: string) => {
    setState(prev => ({
      ...prev,
      tempOverrides: new Map(prev.tempOverrides).set(key, value)
    }));
  }, []);

  const resetOverride = useCallback((key: string) => {
    setState(prev => {
      const newOverrides = new Map(prev.tempOverrides);
      newOverrides.delete(key);
      return { ...prev, tempOverrides: newOverrides };
    });
  }, []);

  const resetAll = useCallback(() => {
    setState(prev => ({ ...prev, tempOverrides: new Map() }));
  }, []);

  return { params, originalParams, state.tempOverrides, updateOverride, resetOverride, resetAll };
};

// ============ ç»„ä»¶ ============

const ParameterRow: React.FC<{
  param: TempOverride;
  onUpdate: (key: string, value: string) => void;
  onReset: (key: string) => void;
}> = ({ param, onUpdate, onReset }) => {
  const [isEditing, setIsEditing] = useState(false);
  const [value, setValue] = useState(param.value);

  const handleSave = () => {
    onUpdate(param.key, value);
    setIsEditing(false);
  };

  return (
    <div className="flex items-center gap-2">
      <span className="w-32 truncate">{param.key}:</span>
      {isEditing ? (
        <>
          <input
            value={value}
            onChange={(e) => setValue(e.target.value)}
            onBlur={handleSave}
            onKeyDown={(e) => {
              if (e.key === 'Enter') handleSave();
              if (e.key === 'Escape') {
                setValue(param.value);
                setIsEditing(false);
              }
            }}
            autoFocus
            className="flex-1 px-2 py-1 border rounded"
          />
          <button onClick={handleSave}>âœ“</button>
        </>
      ) : (
        <>
          <span
            className="flex-1 px-2 py-1 cursor-pointer hover:bg-gray-100"
            onClick={() => setIsEditing(true)}
          >
            {param.value}
          </span>
          {param.isModified && (
            <>
              <span>ğŸ”’</span>
              <button onClick={() => onReset(param.key)}>â†©ï¸</button>
            </>
          )}
        </>
      )}
    </div>
  );
};

const PopupContent: React.FC = () => {
  const options = useCombinationOptions();
  const [selectedId, setSelectedId] = useState<string | null>(null);
  const { params, tempOverrides, updateOverride, resetOverride } = useSessionState(selectedId);
  const [isSaving, setIsSaving] = useState(false);
  const [isRedirecting, setIsRedirecting] = useState(false);

  const handleSave = async () => {
    if (!selectedId) return;
    const combination = getCombinationById(selectedId);
    if (!combination) return;

    setIsSaving(true);
    await saveTempOverridesToCombination(combination, tempOverrides);
    setIsSaving(false);
    // æ¸…é™¤ä¸´æ—¶çŠ¶æ€æˆ–åˆ·æ–°
    window.location.reload();
  };

  const handleRedirect = async () => {
    if (!selectedId) return;
    const combination = getCombinationById(selectedId);
    if (!combination) return;

    const tab = await getCurrentTab();
    const url = buildRedirectURL(tab.url, combination, params);

    setIsRedirecting(true);

    // å…ˆæ‰§è¡Œå†’å……
    const agent = getAgentById(combination.agentId);
    if (agent) {
      const baseURL = buildBaseURL(tab.url, getUriById(combination.uriId)?.uri || '', getPortById(combination.portId)?.port || null);
      const impersonationURL = buildAgentImpersonationURL(baseURL, agent);
      await redirectTab(impersonationURL);

      // ç­‰å¾…å†’å……å®Œæˆåè·³è½¬åˆ°ç›®æ ‡ URL
      setTimeout(() => {
        redirectTab(url);
      }, 500);
    } else {
      await redirectTab(url);
    }
  };

  return (
    <div className="w-[360px] p-4">
      {/* ä¸‹æ‹‰æ¡† */}
      <select
        value={selectedId || ''}
        onChange={(e) => setSelectedId(e.target.value || null)}
        className="w-full mb-4 p-2 border rounded"
      >
        <option value="">é€‰æ‹©é…ç½®...</option>
        {options.map(opt => (
          <option key={opt.id} value={opt.id}>{opt.title}</option>
        ))}
      </select>

      {/* å‚æ•°åˆ—è¡¨ */}
      {selectedId && (
        <div className="space-y-4">
          {/* å°¾éƒ¨å‚æ•° */}
          <div>
            <h3 className="font-semibold mb-2">å°¾éƒ¨å‚æ•°</h3>
            <div className="space-y-2">
              {params.filter(p => !p.key.startsWith('OPTY')).map(param => (
                <ParameterRow
                  key={param.key}
                  param={param}
                  onUpdate={updateOverride}
                  onReset={resetOverride}
                />
              ))}
            </div>
          </div>

          {/* OPTY å‚æ•° */}
          <div>
            <h3 className="font-semibold mb-2">OPTY å‚æ•°</h3>
            <div className="space-y-2">
              {params.filter(p => p.key.startsWith('OPTY')).map(param => (
                <ParameterRow
                  key={param.key}
                  param={param}
                  onUpdate={updateOverride}
                  onReset={resetOverride}
                />
              ))}
            </div>
          </div>

          {/* æŒ‰é’® */}
          <div className="flex gap-2 mt-4">
            <button
              onClick={handleSave}
              disabled={tempOverrides.size === 0 || isSaving}
              className="flex-1 px-4 py-2 bg-blue-500 text-white rounded disabled:bg-gray-300"
            >
              {isSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜é…ç½®'}
            </button>
            <button
              onClick={handleRedirect}
              disabled={isRedirecting}
              className="flex-1 px-4 py-2 bg-green-500 text-white rounded disabled:bg-gray-300"
            >
              {isRedirecting ? 'è·³è½¬ä¸­...' : 'ğŸš€ è·³è½¬'}
            </button>
          </div>
        </div>
      )}
    </div>
  );
};
```

---

## æ ¸å¿ƒé€»è¾‘æ€»ç»“

### åŸŸååˆ¤æ–­é€»è¾‘

å‚è€ƒæ—§ä»£ç ï¼ˆbackup/popup.tsx.bakï¼‰ï¼š

```typescript
// æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦åœ¨å…è®¸çš„åŸŸåä¸‹
const checkDomainPermission = async (
  configuredDomain: string,
): Promise<boolean> => {
  const tab = await getCurrentTab();
  return tab.url.includes(configuredDomain);
};

// åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬åœ°åŸŸå
const isLocalDomain = (url: string): boolean => {
  try {
    const hostname = new URL(url).hostname;
    return (
      hostname === "localhost" ||
      hostname === "127.0.0.1" ||
      hostname.startsWith("192.168.") ||
      hostname.startsWith("10.") ||
      hostname.startsWith("172.")
    );
  } catch {
    return false;
  }
};
```

### ç«¯å£åŒ…å«é€»è¾‘

å‚è€ƒæ—§ä»£ç ï¼ˆbackup/popup.tsx.bakï¼‰çš„ä¸‰æ¡ä»¶åˆ¤æ–­ï¼š

```typescript
const buildBaseURL = (
  currentUrl: string,
  uri: string,
  port: number | null,
  autoPortConversion: boolean = true,
): string => {
  const url = new URL(currentUrl);
  let base = `${url.protocol}//${url.hostname}`;

  // æ¡ä»¶1: æœ¬åœ°åŸŸå + å¼€å¯è‡ªåŠ¨ç«¯å£è½¬æ¢ + é…ç½®äº†ç«¯å£ + å½“å‰URLæœ‰ç«¯å£
  if (isLocalDomain(currentUrl) && autoPortConversion && port && url.port) {
    base = `${base}:${port}`;
  }
  // æ¡ä»¶2: å½“å‰URLæœ‰ç«¯å£
  else if (url.port) {
    base = `${base}:${url.port}`;
  }
  // æ¡ä»¶3: ä¸åŒ…å«ç«¯å£

  return `${base}${uri}`;
};
```

### å‚æ•°æ„å»ºé€»è¾‘

```typescript
const buildQueryString = (params: TempOverride[]): string => {
  return params.map((p) => `${p.key}=${p.value}`).join("&");
};

// æ—§ä»£ç ä¸­ï¼ŒOPTY å‚æ•°ä¼šæ·»åŠ  opty_ å‰ç¼€
const buildLegacyQueryString = (params: TempOverride[]): string => {
  const optyParams = params
    .filter((p) => p.key.startsWith("OPTY"))
    .map((p) => `opty_${p.key}=${p.value}`);

  const tailParams = params
    .filter((p) => !p.key.startsWith("OPTY"))
    .map((p) => `${p.key}=${p.value}`);

  return [...optyParams, ...tailParams].join("&");
};
```

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **å®ç°æ•°æ®å±‚** - æ‰€æœ‰çº¯å‡½æ•°å’Œå­˜å‚¨æ“ä½œ
2. **å®ç° UI å±‚** - React ç»„ä»¶å’Œ Hooks
3. **é›†æˆæµ‹è¯•** - æµ‹è¯• URL æ„å»ºé€»è¾‘
4. **å§”æ‰˜ UI/UX å·¥ç¨‹å¸ˆ** - ä¼˜åŒ–è§†è§‰æ•ˆæœå’ŒåŠ¨ç”»
